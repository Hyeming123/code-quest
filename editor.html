
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cì½”ë“œ ì…ë ¥ - ë¡œì»¬ ì»´íŒŒì¼ëŸ¬</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    .editor-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
      height: 600px;
    }

    .editor-section, .output-section {
      display: flex;
      flex-direction: column;
      background-color: #1e1e1e;
      border: 1px solid #3c3c3c;
      border-radius: 8px;
      overflow: hidden;
    }

    .section-title {
      background-color: #252526;
      padding: 10px 15px;
      color: #4fc3f7;
      font-weight: bold;
      border-bottom: 1px solid #3c3c3c;
    }

    textarea {
      flex: 1;
      padding: 15px;
      background-color: #1e1e1e;
      color: #d4d4d4;
      border: none;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 14px;
      resize: none;
      outline: none;
    }

    textarea:focus {
      background-color: #252526;
    }

    .output-content {
      flex: 1;
      padding: 15px;
      color: #d4d4d4;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 14px;
      overflow-y: auto;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .output-content.error {
      color: #ff6b6b;
    }

    .output-content.success {
      color: #6bff6b;
    }

    .button-group {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    button {
      padding: 12px 24px;
      background-color: #0e639c;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #1177bb;
    }

    button:active {
      background-color: #0d5a8f;
    }

    button:disabled {
      background-color: #555555;
      cursor: not-allowed;
    }

    .clear-btn {
      background-color: #555555;
    }

    .clear-btn:hover {
      background-color: #666666;
    }

    .info-box {
      background-color: #1e3a5f;
      border-left: 4px solid #4fc3f7;
      padding: 12px;
      border-radius: 4px;
      margin: 20px 0;
      font-size: 13px;
      color: #b0b0b0;
    }

    .user-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding: 15px;
      background-color: #252526;
      border-radius: 4px;
    }

    .user-email {
      color: #4fc3f7;
    }

    .logout-btn {
      background-color: #c82333;
      padding: 8px 16px;
      font-size: 14px;
    }

    .logout-btn:hover {
      background-color: #a01d28;
    }

    @media (max-width: 768px) {
      .editor-container {
        grid-template-columns: 1fr;
        height: auto;
      }

      .editor-section, .output-section {
        height: 400px;
      }
    }
  </style>
</head>
<body>
<header>Cì–¸ì–´ ì˜¨ë¼ì¸ ì»´íŒŒì¼ëŸ¬</header>

<nav>
  <a href="index.html">ë©”ì¸</a>
  <a href="login.html">ë¡œê·¸ì¸</a>
</nav>

<div class="container">
  <div class="user-info">
    <span class="user-email" id="userEmail">ë¡œê·¸ì¸í•˜ì§€ ì•ŠìŒ</span>
    <button class="logout-btn" onclick="logout()" id="logoutBtn" style="display: none;">ë¡œê·¸ì•„ì›ƒ</button>
  </div>

  <div class="info-box">
    ğŸ’¡ ë¡œì»¬ ì»´íŒŒì¼ëŸ¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ê¸°ë³¸ C ì½”ë“œ ì‹¤í–‰ì„ ì§€ì›í•©ë‹ˆë‹¤. ì½”ë“œë¥¼ ì…ë ¥í•˜ê³  "â–¶ ì‹¤í–‰" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.
  </div>

  <div class="button-group">
    <button onclick="runCode()" id="runBtn">â–¶ ì‹¤í–‰</button>
    <button class="clear-btn" onclick="clearCode()">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
  </div>

  <div class="editor-container">
    <div class="editor-section">
      <div class="section-title">ğŸ“ C ì½”ë“œ ì…ë ¥</div>
      <textarea id="codeEditor" placeholder="#include <stdio.h>

int main() {
    printf(&quot;Hello, World!\n&quot;);
    return 0;
}">#include <stdio.h>

int main() {
    printf("Hello, World!\n");
    return 0;
}</textarea>
    </div>

    <div class="output-section">
      <div class="section-title">ğŸ“¤ ì‹¤í–‰ ê²°ê³¼</div>
      <div class="output-content" id="output">ì—¬ê¸°ì— ì‹¤í–‰ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.</div>
    </div>
  </div>

  <div class="info-box">
    <strong>ğŸ“Œ ì§€ì›í•˜ëŠ” ê¸°ëŠ¥:</strong>
    <ul>
      <li>âœ… printf() ì¶œë ¥</li>
      <li>âœ… ë³€ìˆ˜ ì„ ì–¸ ë° ê³„ì‚°</li>
      <li>âœ… if/else ì¡°ê±´ë¬¸</li>
      <li>âœ… for/while ë°˜ë³µë¬¸</li>
      <li>âœ… ë°°ì—´ (ê¸°ë³¸ ì§€ì›)</li>
      <li>âš ï¸ íŒŒì¼ ì…ì¶œë ¥ (ë¯¸ì§€ì›)</li>
      <li>âš ï¸ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ (ë¯¸ì§€ì›)</li>
    </ul>
  </div>

  <div class="info-box">
    <strong>ğŸ“ ì˜ˆì œ ì½”ë“œ:</strong>
    <pre style="background-color: #0d0d0d; padding: 10px; border-radius: 4px; overflow-x: auto;"><code>#include &lt;stdio.h&gt;

int main() {
    int a = 10, b = 20;
    printf("a + b = %d\n", a + b);
    return 0;
}</code></pre>
  </div>

  <div class="info-box">
    <strong>âš ï¸ ì£¼ì˜ì‚¬í•­:</strong>
    <ul>
      <li>ì´ê²ƒì€ í•™ìŠµìš© ë¡œì»¬ ì»´íŒŒì¼ëŸ¬ì…ë‹ˆë‹¤.</li>
      <li>ì‹¤ì œ C ì»´íŒŒì¼ëŸ¬ì™€ ì™„ì „íˆ ë™ì¼í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
      <li>ë³µì¡í•œ ì½”ë“œëŠ” ì§€ì›í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
      <li>íŒŒì¼ ì…ì¶œë ¥ í•¨ìˆ˜ëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</li>
    </ul>
  </div>
</div>

<script>
// í˜ì´ì§€ ë¡œë“œ ì‹œ ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
window.addEventListener('load', () => {
  const currentUser = localStorage.getItem('currentUser');
  if (currentUser) {
    document.getElementById('userEmail').textContent = currentUser;
    document.getElementById('logoutBtn').style.display = 'block';
  }
});

// ê°„ë‹¨í•œ C ì½”ë“œ ì‹œë®¬ë ˆì´í„°
function simulateC(code) {
  let output = '';
  
  try {
    // printf í•¨ìˆ˜ ì‹œë®¬ë ˆì´ì…˜
    const printfRegex = /printf\s*\(\s*"([^"]*)"\s*(?:,\s*([^)]*))?\s*\)/g;
    
    // ë³€ìˆ˜ ì €ì¥ì†Œ
    let variables = {};
    
    // 1. ë³€ìˆ˜ ì„ ì–¸ íŒŒì‹±
    const varDeclRegex = /int\s+(\w+)\s*=\s*(\d+)/g;
    let match;
    while ((match = varDeclRegex.exec(code)) !== null) {
      variables[match[1]] = parseInt(match[2]);
    }
    
    // 2. printf ë¬¸ ì²˜ë¦¬
    let lineOutput = '';
    const lines = code.split('\n');
    
    for (let line of lines) {
      // printf ì²˜ë¦¬
      if (line.includes('printf')) {
        const printfMatch = /printf\s*\(\s*"([^"]*)"\s*(?:,\s*([^)]*))?\s*\)/.exec(line);
        if (printfMatch) {
          let formatStr = printfMatch[1];
          let args = printfMatch[2] ? printfMatch[2].split(',').map(s => s.trim()) : [];
          
          // í¬ë§· ë¬¸ìì—´ ì²˜ë¦¬
          let argIndex = 0;
          let result = formatStr.replace(/%d|%s|%f/g, (match) => {
            if (argIndex < args.length) {
              let arg = args[argIndex++];
              // ë³€ìˆ˜ ì¹˜í™˜
              if (variables[arg] !== undefined) {
                return variables[arg];
              }
              // ìˆ«ì ì§ì ‘ ì…ë ¥
              if (!isNaN(arg)) {
                return arg;
              }
              return arg;
            }
            return match;
          });
          
          // ì´ìŠ¤ì¼€ì´í”„ ì‹œí€€ìŠ¤ ì²˜ë¦¬
          result = result.replace(/\\n/g, '\n');
          result = result.replace(/\\t/g, '\t');
          result = result.replace(/\\r/g, '\r');
          
          output += result;
        }
      }
      
      // ê°„ë‹¨í•œ ê³„ì‚° ì²˜ë¦¬ (ì˜ˆ: a + b)
      if (line.includes('=') && !line.includes('int ')) {
        const assignRegex = /(\w+)\s*=\s*([^;]+)/;
        const assignMatch = assignRegex.exec(line);
        if (assignMatch) {
          let varName = assignMatch[1];
          let expr = assignMatch[2].trim();
          
          // ê°„ë‹¨í•œ ì‚°ìˆ  ì—°ì‚°
          try {
            // ë³€ìˆ˜ë¥¼ ê°’ìœ¼ë¡œ ì¹˜í™˜
            let evalExpr = expr;
            for (let [key, value] of Object.entries(variables)) {
              evalExpr = evalExpr.replace(new RegExp('\\b' + key + '\\b', 'g'), value);
            }
            variables[varName] = eval(evalExpr);
          } catch (e) {
            // ê³„ì‚° ì‹¤íŒ¨ ë¬´ì‹œ
          }
        }
      }
    }
    
    // 3. ë°˜ë³µë¬¸ ì²˜ë¦¬ (ê¸°ë³¸ for ë£¨í”„)
    const forRegex = /for\s*\(\s*int\s+(\w+)\s*=\s*(\d+)\s*;\s*\1\s*<=\s*(\d+)\s*;\s*\1\+\+\s*\)\s*\{([^}]*)\}/;
    let forMatch;
    while ((forMatch = forRegex.exec(code)) !== null) {
      let varName = forMatch[1];
      let start = parseInt(forMatch[2]);
      let end = parseInt(forMatch[3]);
      let body = forMatch[4];
      
      for (let i = start; i <= end; i++) {
        variables[varName] = i;
        
        // ë£¨í”„ ë³¸ë¬¸ì˜ printf ì²˜ë¦¬
        const loopPrintfRegex = /printf\s*\(\s*"([^"]*)"\s*(?:,\s*([^)]*))?\s*\)/;
        const loopMatch = loopPrintfRegex.exec(body);
        if (loopMatch) {
          let formatStr = loopMatch[1];
          let args = loopMatch[2] ? loopMatch[2].split(',').map(s => s.trim()) : [];
          
          let result = formatStr.replace(/%d|%s|%f/g, (match) => {
            if (args.length > 0) {
              let arg = args.shift();
              if (variables[arg] !== undefined) {
                return variables[arg];
              }
              if (!isNaN(arg)) {
                return arg;
              }
              return arg;
            }
            return match;
          });
          
          result = result.replace(/\\n/g, '\n');
          result = result.replace(/\\t/g, '\t');
          output += result;
        }
      }
    }
    
    return output || 'âœ… ì½”ë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.';
    
  } catch (error) {
    return `âŒ ì˜¤ë¥˜: ${error.message}`;
  }
}

// C ì½”ë“œ ì‹¤í–‰ í•¨ìˆ˜
function runCode() {
  const code = document.getElementById('codeEditor').value;
  const output = document.getElementById('output');

  if (!code.trim()) {
    output.textContent = 'âŒ ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
    output.className = 'output-content error';
    return;
  }

  try {
    const result = simulateC(code);
    output.textContent = result;
    output.className = 'output-content success';
  } catch (error) {
    output.textContent = `âŒ ì˜¤ë¥˜: ${error.message}`;
    output.className = 'output-content error';
  }
}

// ì½”ë“œ ì´ˆê¸°í™” í•¨ìˆ˜
function clearCode() {
  if (confirm('ì½”ë“œë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
    document.getElementById('codeEditor').value = '#include <stdio.h>\n\nint main() {\n    printf("Hello, World!\\n");\n    return 0;\n}';
    document.getElementById('output').textContent = 'ì—¬ê¸°ì— ì‹¤í–‰ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.';
    document.getElementById('output').className = 'output-content';
  }
}

// ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜
function logout() {
  localStorage.removeItem('currentUser');
  window.location.href = 'login.html';
}

// Ctrl+Enterë¡œ ì½”ë“œ ì‹¤í–‰
document.addEventListener('keydown', (e) => {
  if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
    runCode();
  }
});
</script>
</body>
</html>
